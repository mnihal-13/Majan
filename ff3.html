<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Majan-Eye-Centre</title>
    <meta name="description" content="Majan Eye Care">
    <meta name="author" content="Brillowelle">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Place favicon.ico in the root directory -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/favicon.svg">
    <!-- CSS here -->
    <link rel="stylesheet" href="assets/css/vendor/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/vendor/animate.min.css">
    <link rel="stylesheet" href="assets/css/plugins/swiper.min.css">
    <link rel="stylesheet" href="assets/css/vendor/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/vendor/fontawesome-pro.css">
    <link rel="stylesheet" href="assets/css/vendor/spacing.css"> 
    <link rel="stylesheet" href="assets/css/plugins/odometer-theme-default.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Ajax script -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body class="body-1">



    <main>


    <section class="pricing-appointment mt-5 mt-sm-40 mt-xs-30">
        <div class="container">
            <div class="row align-items-center text-center mb-60 mb-sm-50 mb-xs-40">
                <div class="">
                    <div class="section__title-wrapper">
                        <h5 class="section__subtitle color-theme-primary mb-15 mb-xs-10 title-animation">Give Your Feedback</h5>
                        <!-- <h2 class="section__title mb-0 title-animation">Strengthen Your Vison With Us</h2> -->
                        <img src="assets/imgs/majaan-logo.png" alt="" height="100px">
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Contact Form -->
                <div class="col-lg-12">
                    <form id="gform"  method="" action="" class="pricing-appointment__form mt-md-60 mt-sm-60 mt-xs-60">
                        <h4 class="text-center section__title mb-15 title-animation">Majan Eye Centre – Patient Feedback Form</h4>
                        <h4 class="text-center section__title mb-15 title-animation">نموذج تقييم المرضى – مركز مجان للعيون</h4>
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="pricing-appointment__form-input">
                                    <input name="name" id="name" type="text" placeholder="Your name ( الاسم )" required>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <input name="date" id="date" type="text" placeholder="Date ( التاريخ )" required>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <input name="mr-no" id="mr_no" type="number" placeholder="Mr No" required>
                                </div>
                            </div><br><br>

                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Overall Experience ( التجربة العامة )</label>
                                    <div class="star-rating" data-target="exp">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="overall_experience" id="exp" required>
                                    <!-- <input name="overall-experience" id="exp" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Doctor’s Care ( تعامل الطبيب )</label>
                                    <div class="star-rating" data-target="care">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="care" id="care" required>
                                    <!-- <input name="Dr-care" id="care" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Service from the Front Desk ( خدمة موظفي الاستقبال )</label>
                                    <div class="star-rating" data-target="fd_service">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="fd_service" id="fd_service" required>
                                    <!-- <input name="FrontD-Service" id="fd_service" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Cleanliness of the Clinic ( نظافة العيادة )</label>
                                    <div class="star-rating" data-target="cleanliness">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="cleanliness" id="cleanliness" required>
                                    <!-- <input name="Cleanliness" id="cleanliness" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Staff Friendliness ( ودّ وتعامل الموظفين )</label>
                                    <div class="star-rating" data-target="staff">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="staff" id="staff" required>
                                    <!-- <input name="Staff-friendliness" id="staff" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Nursing Service</label>
                                    <div class="star-rating" data-target="nurse_services">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="nurse_services" id="nurse_services" required>
                                    <!-- <input name="Nursing-service" id="nurse_services" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Rate the Explanation by the doctor / staff about your Condition & Treatment <br> ( وضوح شرح الحالة والعلاج )</label>
                                    <div class="star-rating" data-target="explanation">
                                        <span data-value="1">★</span>
                                        <span data-value="2">★</span>
                                        <span data-value="3">★</span>
                                        <span data-value="4">★</span>
                                        <span data-value="5">★</span>
                                    </div>
                                    <input type="hidden" name="explanation" id="explanation" required>
                                    <!-- <input name="Explanations-of-Dr/staff" id="explanation" type="number" placeholder="⭐1⭐2⭐3⭐4⭐5" min="0" max="5" required> -->
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6">
                                <div class="pricing-appointment__form-input">
                                    <label for="">Would you recommend Majan Eye Centre to others? <br> ( هل تنصح بمركز مجان للعيون للآخرين؟ )</label>
                                    <div class="pricing-appointment__form-select">
                                        <label style="margin-right: 10px;">
                                            <input type="radio" name="recommend" value="Yes" required> Yes
                                        </label>
                                        <label>
                                            <input type="radio" name="recommend" value="No" required> No
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="pricing-appointment__form-input">
                                    <textarea name="advice-for-improve" id="advice" placeholder="Any advice for us to improve further"></textarea>
                                </div>
                            </div>

                            <div class="col-12">
                                <button type="submit" class="rr-btn rr-btn__primary-color mt-0">
                                    <span class="btn-wrap">
                                        <span class="text-one">Send Now<i class="fa-solid fa-paper-plane-top"></i></span>
                                        <span class="text-two">Send Now<i class="fa-solid fa-paper-plane-top"></i></span>
                                    </span>
                                </button>
                                <p id="submit-alert"></p>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>




    <!-- JS here -->
    <!-- <script>
        // Form submission using AJAX
        $("#gform").submit((e)=>{
            e.preventDefault()
            $.ajax({
                url:"https://script.google.com/macros/s/AKfycbx68ZBJluLdS2mTa0OcsQVhC-qEvjklleyXKTYPX3kujHkUhN-1NxBeV9w_azK2oBMo/exec",
                data:$("#gform").serialize(),
                method:"post",
                success: function(response) {
                    $("#submit-alert").text("Form Submitted Successfully!!").css({"display":"contents", "color": "#50b948", "font-weight": "900"});
                    setTimeout(() => window.location.reload(), 10000); // Reload after 10 seconds
                },
                error: function(err) {
                    $("#submit-alert").text("Something Went Wrong!..Check filled details are correct and Submit again or Please try Contacting through WhatsApp or Mobile Number").css({"display":"contents", "color": "red", "font-weight": "900"});
                }
            })
        })
    </script> -->
    <script>
        const ENDPOINT = "https://script.google.com/macros/s/AKfycbxift1MnwoKILSGNidZCtHMIhLEmXEKsCJLootdr2nhz_8ipaifxO16ZXz4AoZlYRtS/exec";  // replace with your actual deployment ID
        const STORAGE_KEY = "offline_feedback_queue";

        function saveOffline(data) {
            let queue = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            queue.push(data);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(queue));
        }

        function sendToServer(data, callback) {
            $.ajax({
                url: ENDPOINT,
                data: data,
                method: "POST",
                success: function (response) {
                    callback(true);
                },
                error: function () {
                    callback(false);
                }
            });
        }

        // Submit handler
        // $("#gform").submit(function (e) {
        //     e.preventDefault();

        //     const formData = {
        //         name: $("#name").val(),
        //         date: $("#date").val(),
        //         mr_no: $("#mr_no").val(),
        //         exp: $("#exp").val(),
        //         care: $("#care").val(),
        //         fd_service: $("#fd_service").val(),
        //         cleanliness: $("#cleanliness").val(),
        //         staff: $("#staff").val(),
        //         nurse_services: $("#nurse_services").val(),
        //         explanation: $("#explanation").val(),
        //         recommend: $('input[name="recommend"]:checked').val(),
        //         advice: $("#advice").val(),
        //         formGoogleSheetName: "responses",
        //         formGoogleSendEmail: "mnkv1013@gmail.com",
        //         formDataNameOrder: JSON.stringify(["name", "date", "mr_no", "exp", "care", "fd_service", "cleanliness", "staff", "nurse_services", "explanation", "recommend", "advice"])
        //     };

        //     if (navigator.onLine) {
        //         sendToServer(formData, function (success) {
        //             if (success) {
        //                 $("#submit-alert").text("Feedback submitted! ✅").css({"color": "#50b948", "font-weight": "900"});
        //                 // setTimeout(() => window.location.reload(), 5000);
        //                     setTimeout(() => {
        //                         $("#gform").fadeOut(500, function () {
        //                             resetForm();
        //                             $("#gform").fadeIn(500);
        //                             $("#submit-alert").text("");
        //                         });
        //                     }, 5000);
        //             } else {
        //                 saveOffline(formData);
        //                 $("#submit-alert").text("Connection error. Saved offline, will retry when online! ⚠️").css({ color: "orange", "font-weight": "900" });
        //                 setTimeout(() => {
        //                         $("#gform").fadeOut(500, function () {
        //                             resetForm();
        //                             $("#gform").fadeIn(500);
        //                             $("#submit-alert").text("");
        //                         });
        //                     }, 5000);
        //             }
        //         });
        //     } else {
        //         saveOffline(formData);
        //         $("#submit-alert").text("No internet. Saved offline, will retry when online! ⚠️").css({ color: "orange", "font-weight": "900"});
        //             setTimeout(() => {
        //                 $("#gform").fadeOut(500, function () {
        //                     resetForm();                     
        //                     $("#gform").fadeIn(500);         
        //                     $("#submit-alert").text("");
        //                 });
        //             }, 5000);
        //         }
        // });

        $("#gform").submit(function (e) {
            e.preventDefault();

            // Validate all star ratings
            const requiredRatings = [
                "#exp",
                "#care",
                "#fd_service",
                "#cleanliness",
                "#staff",
                "#nurse_services",
                "#explanation"
            ];

            let allStarsSelected = true;
            requiredRatings.forEach(id => {
                if (!$(id).val()) {
                    allStarsSelected = false;
                    $(`div[data-target='${id.replace("#", "")}']`).addClass("rating-error");
                } else {
                    $(`div[data-target='${id.replace("#", "")}']`).removeClass("rating-error");
                }
            });

            // Validate radio (recommendation)
            const recommendValue = $('input[name="recommend"]:checked').val();
            if (!recommendValue) {
                $("#submit-alert").text("Please select Yes or No for recommendation.").css({ color: "red", "font-weight": "900" });
                return;
            }

            if (!allStarsSelected) {
                $("#submit-alert").text("Please rate all fields before submitting.").css({ color: "red", "font-weight": "900" });
                return;
            }

            // If everything valid, proceed
            const formData = {
                name: $("#name").val(),
                date: $("#date").val(),
                mr_no: $("#mr_no").val(),
                exp: $("#exp").val(),
                care: $("#care").val(),
                fd_service: $("#fd_service").val(),
                cleanliness: $("#cleanliness").val(),
                staff: $("#staff").val(),
                nurse_services: $("#nurse_services").val(),
                explanation: $("#explanation").val(),
                recommend: recommendValue,
                advice: $("#advice").val(),
                formGoogleSheetName: "responses",
                formGoogleSendEmail: "mnkv1013@gmail.com",
                formDataNameOrder: JSON.stringify(["name", "date", "mr_no", "exp", "care", "fd_service", "cleanliness", "staff", "nurse_services", "explanation", "recommend", "advice"])
            };

            if (navigator.onLine) {
                sendToServer(formData, function (success) {
                    if (success) {
                        $("#submit-alert").text("Feedback submitted! ✅").css({ "color": "#50b948", "font-weight": "900" });
                        setTimeout(() => {
                            $("#gform").fadeOut(500, function () {
                                resetForm();
                                $("#gform").fadeIn(500);
                                $("#submit-alert").text("");
                            });
                        }, 5000);
                    } else {
                        saveOffline(formData);
                        $("#submit-alert").text("Connection error. Saved offline! ⚠️").css({ color: "orange", "font-weight": "900" });
                        setTimeout(() => {
                            $("#gform").fadeOut(500, function () {
                                resetForm();
                                $("#gform").fadeIn(500);
                                $("#submit-alert").text("");
                            });
                        }, 5000);
                    }
                });
            } else {
                saveOffline(formData);
                $("#submit-alert").text("No internet. Saved offline! ⚠️").css({ color: "orange", "font-weight": "900" });
                setTimeout(() => {
                    $("#gform").fadeOut(500, function () {
                        resetForm();
                        $("#gform").fadeIn(500);
                        $("#submit-alert").text("");
                    });
                }, 5000);
            }
        });

        // Retry unsent offline data every 5 seconds
        setInterval(function () {
            if (navigator.onLine) {
                let queue = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
                if (queue.length > 0) {
                    const next = queue.shift(); // remove first
                    sendToServer(next, function (success) {
                        if (success) {
                            localStorage.setItem(STORAGE_KEY, JSON.stringify(queue));
                            $("#submit-alert").text("Offline feedback synced ✅").css({ color: "#50b948", "font-weight": "900" });
                        } else {
                            queue.unshift(next); // put it back
                            localStorage.setItem(STORAGE_KEY, JSON.stringify(queue));
                        }
                    });
                }
            }
        }, 5000);

        // Reset form inpout after submission
        function resetForm() {
            $('#gform')[0].reset();
            $(".star-rating span").removeClass("selected");
        }
    </script>
    <script>
        $(".star-rating span").on("click", function () {
            const value = $(this).data("value");
            const wrapper = $(this).closest(".star-rating");
            const inputId = wrapper.data("target");

            // Highlight stars up to the clicked one
            wrapper.find("span").removeClass("selected");
            wrapper.find("span").each(function () {
            if ($(this).data("value") <= value) {
                $(this).addClass("selected");
            }
            });

            // Set hidden input value
            $("#" + inputId).val(value);
        });
    </script>
    <script src="assets/js/vendor/jquery-3.7.1.min.js"></script>
    <script src="assets/js/plugins/waypoints.min.js"></script>
    <script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="assets/js/plugins/meanmenu.min.js"></script>
    <script src="assets/js/plugins/odometer.min.js"></script>
    <script src="assets/js/plugins/swiper.min.js"></script>
    <script src="assets/js/plugins/wow.js"></script>
    <script src="assets/js/vendor/magnific-popup.min.js"></script>
    <script src="assets/js/vendor/type.js"></script>
    <script src="assets/js/plugins/nice-select.min.js"></script>
    <script src="assets/js/vendor/jquery-ui.min.js"></script>
    <script src="assets/js/vendor/jquery.appear.js"></script>
    <script src="assets/js/plugins/parallax.min.js"></script>
    <script src="assets/js/plugins/parallax-scroll.js"></script>
    <script src="assets/js/plugins/gsap.min.js"></script>
    <script src="assets/js/plugins/ScrollTrigger.min.js"></script>
    <script src="assets/js/plugins/SplitText.js"></script>
    <script src="assets/js/plugins/tween-max.min.js"></script>
    <script src="assets/js/plugins/draggable.min.js"></script>
    <script src="assets/js/plugins/smoothscroll.js"></script>
    <script src="assets/js/vendor/ajax-form.js"></script>
    <script src="assets/js/main.js"></script>
    
</body>

</html>